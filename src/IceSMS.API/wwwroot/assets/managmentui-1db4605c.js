import{j as e,r as x,u as H}from"./index-408549ef.js";import{A as Q}from"./app-layout-10f771d5.js";import{u as w,l as j,a as W,g as Y,T as G,d as J,e as b,f as U,h as C,i as X,j as S,D as Z,S as _,n as K,o as D,p as A,q as f}from"./data-table-pagination-74889f99.js";import{c as ee,B as v,I as h}from"./input-5d80ed27.js";import{L as u}from"./label-b39d9593.js";import{C as I,b as M,c as B,a as T}from"./card-d535f7d7.js";import{c as ae}from"./utils-b13f04d9.js";import{c as te}from"./createLucideIcon-ccf82dc6.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],se=te("Plus",re),ne=ee("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function ie({className:m,variant:p,...d}){return e.jsx("div",{className:ae(ne({variant:p}),m),...d})}function ye(){const[m,p]=x.useState(""),[d,q]=x.useState({pageIndex:0,pageSize:10}),{data:c}=w({queryKey:["tenants",d,m],queryFn:async()=>{var n;const a=(n=document.cookie.split("; ").find(o=>o.startsWith("token=")))==null?void 0:n.split("=")[1],r=new URLSearchParams({page:(d.pageIndex+1).toString(),limit:d.pageSize.toString(),search:m}),s=await fetch(`/api/v1/tenants?${r}`,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(!s.ok)throw new Error("API hatası");return s.json()}}),{data:i}=w({queryKey:["currentUser"],queryFn:async()=>{var s;const a=(s=document.cookie.split("; ").find(n=>n.startsWith("token=")))==null?void 0:s.split("=")[1],r=await fetch("/api/v1/auth/me",{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(!r.ok)throw new Error("API hatası");return r.json()}}),N=[{accessorKey:"ID",header:"ID"},{accessorKey:"name",header:"Ad"},{accessorKey:"title",header:"Başlık"},{accessorKey:"domain_name",header:"Domain"},{accessorKey:"tenant_type",header:"Tip",cell:a=>{switch(a.getValue()){case 1:return"Host";case 2:return"Bayi";case 3:return"Müşteri";default:return"Bilinmeyen"}}},{accessorKey:"tenant_credit",header:"Kredi"},{accessorKey:"is_active",header:"Durum",cell:({row:a})=>e.jsx(ie,{variant:a.getValue("is_active")?"default":"destructive",children:a.getValue("is_active")?"Aktif":"Pasif"})},{accessorKey:"CreatedAt",header:"Oluşturulma Tarihi",cell:a=>new Date(a.getValue()).toLocaleDateString()},{accessorKey:"UpdatedAt",header:"Güncelleme Tarihi",cell:a=>new Date(a.getValue()).toLocaleDateString()},{id:"actions",cell:({row:a})=>e.jsxs("div",{className:"space-x-2",children:[e.jsx("button",{onClick:()=>V(a.original),children:"Düzenle"}),e.jsx("button",{onClick:()=>$(a.original.ID),children:"Sil"})]})}],[z,g]=x.useState(!1),[t,l]=x.useState(null),k=H(),P=j({mutationFn:async a=>{var n;const r=(n=document.cookie.split("; ").find(o=>o.startsWith("token=")))==null?void 0:n.split("=")[1],s=await fetch("/api/v1/tenants",{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify(a)});if(!s.ok)throw new Error("Oluşturma hatası");return s.json()},onSuccess:()=>k.invalidateQueries({queryKey:["tenants"]})}),E=j({mutationFn:async a=>{var n;const r=(n=document.cookie.split("; ").find(o=>o.startsWith("token=")))==null?void 0:n.split("=")[1],s=await fetch(`/api/v1/tenants/${a.ID}`,{method:"PUT",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify(a)});if(!s.ok)throw new Error("Güncelleme hatası");return s.json()},onSuccess:()=>k.invalidateQueries({queryKey:["tenants"]})}),F=j({mutationFn:async a=>{var n;const r=(n=document.cookie.split("; ").find(o=>o.startsWith("token=")))==null?void 0:n.split("=")[1],s=await fetch(`/api/v1/tenants/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${r}`}});if(!s.ok)throw new Error("Silme hatası");return s.json()},onSuccess:()=>k.invalidateQueries({queryKey:["tenants"]})}),V=a=>{l(a),g(!0)},R=a=>{a.preventDefault(),t&&(t.ID?E.mutate(t):P.mutate(t),g(!1),l(null))},L=a=>{switch(a){case 1:return[{value:"2",label:"Bayi"},{value:"3",label:"Müşteri"}];case 2:return[{value:"3",label:"Müşteri"}];default:return[]}},O=()=>{l({ID:0,name:"",title:"",favicon:"",logo:"",tenant_type:(i==null?void 0:i.tenant_type)===1?2:3,is_active:!0,tenant_credit:0,domain_name:"",tenant_cover_image:"",parent_id:0,CreatedAt:"",UpdatedAt:"",DeletedAt:null}),g(!0)},$=a=>{confirm("Silmek istediğinize emin misiniz?")&&F.mutate(a)},y=W({data:(c==null?void 0:c.data)||[],columns:N,pageCount:(c==null?void 0:c.total_page)||-1,state:{pagination:d},manualPagination:!0,onPaginationChange:q,getCoreRowModel:Y()});return e.jsx(Q,{title:"Kiracı Yönetim",children:e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight dark:text-gray-100",children:"Kiracı Yönetimi"}),e.jsxs(v,{onClick:O,children:[e.jsx(se,{className:"mr-2 h-4 w-4"})," Yeni Kiracı"]})]}),e.jsxs(I,{className:"dark:border-gray-800",children:[e.jsx(M,{className:"space-y-0 pb-4 dark:border-gray-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(B,{className:"dark:text-gray-100",children:"Kiracılar"}),e.jsx("div",{className:"flex w-full max-w-sm items-center space-x-2",children:e.jsx(h,{placeholder:"Kiracı ara...",value:m,onChange:a=>p(a.target.value),className:"h-9 dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100"})})]})}),e.jsxs(T,{children:[e.jsx("div",{className:"rounded-md border dark:border-gray-800",children:e.jsxs(G,{children:[e.jsx(J,{children:y.getHeaderGroups().map(a=>e.jsx(b,{className:"dark:border-gray-800",children:a.headers.map(r=>e.jsx(U,{className:"dark:text-gray-400",children:C(r.column.columnDef.header,r.getContext())},r.id))},a.id))}),e.jsx(X,{children:y.getRowModel().rows.length?y.getRowModel().rows.map(a=>e.jsx(b,{className:"dark:border-gray-800 dark:hover:bg-gray-900",children:a.getVisibleCells().map(r=>e.jsx(S,{className:"dark:text-gray-300",children:C(r.column.columnDef.cell,r.getContext())},r.id))},a.id)):e.jsx(b,{children:e.jsx(S,{colSpan:N.length,className:"h-24 text-center dark:text-gray-400",children:"Kayıt bulunamadı."})})})]})}),e.jsx("div",{className:"mt-4",children:e.jsx(Z,{table:y})})]})]}),z&&e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 dark:bg-gray-950/80",children:e.jsx("div",{className:"fixed left-[50%] top-[50%] z-50 grid w-full max-w-3xl translate-x-[-50%] translate-y-[-50%]",children:e.jsxs(I,{className:"dark:border-gray-800",children:[e.jsx(M,{className:"dark:border-gray-800",children:e.jsx(B,{className:"dark:text-gray-100",children:t!=null&&t.ID?"Kiracı Düzenle":"Yeni Kiracı Ekle"})}),e.jsx(T,{children:e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"name",className:"dark:text-gray-100",children:"Ad"}),e.jsx(h,{id:"name",value:(t==null?void 0:t.name)||"",onChange:a=>l({...t,name:a.target.value}),required:!0,className:"dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"title",className:"dark:text-gray-100",children:"Başlık"}),e.jsx(h,{id:"title",value:(t==null?void 0:t.title)||"",onChange:a=>l({...t,title:a.target.value}),required:!0,className:"dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"domain_name",className:"dark:text-gray-100",children:"Domain"}),e.jsx(h,{id:"domain_name",value:(t==null?void 0:t.domain_name)||"",onChange:a=>l({...t,domain_name:a.target.value}),required:!0,className:"dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"tenant_credit",className:"dark:text-gray-100",children:"Kredi"}),e.jsx(h,{id:"tenant_credit",type:"number",value:(t==null?void 0:t.tenant_credit)||0,onChange:a=>l({...t,tenant_credit:Number(a.target.value)}),className:"dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"status",className:"dark:text-gray-100",children:"Durum"}),e.jsxs(_,{value:t!=null&&t.is_active?"1":"0",onValueChange:a=>l({...t,is_active:!!Number(a)}),children:[e.jsx(K,{className:"dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100",children:e.jsx(D,{placeholder:"Durum seçin"})}),e.jsxs(A,{className:"dark:bg-gray-950 dark:border-gray-800",children:[e.jsx(f,{value:"1",className:"dark:text-gray-100",children:"Aktif"}),e.jsx(f,{value:"0",className:"dark:text-gray-100",children:"Pasif"})]})]})]}),e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx(u,{htmlFor:"tenant_type",className:"dark:text-gray-100",children:"Kiracı Tipi"}),e.jsxs(_,{value:String(t==null?void 0:t.tenant_type),onValueChange:a=>l({...t,tenant_type:Number(a)}),required:!0,disabled:!(i!=null&&i.data),children:[e.jsx(K,{className:"dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100",children:e.jsx(D,{placeholder:"Kiracı tipi seçin"})}),e.jsx(A,{className:"dark:bg-gray-950 dark:border-gray-800",children:(i==null?void 0:i.data)&&L(i.data.tenant_type).map(a=>e.jsx(f,{value:a.value,className:"dark:text-gray-100",children:a.label},a.value))})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(v,{variant:"outline",onClick:()=>g(!1),className:"dark:border-gray-800 dark:hover:bg-gray-900",children:"İptal"}),e.jsx(v,{type:"submit",children:"Kaydet"})]})]})})]})})})]})})}export{ye as default};
